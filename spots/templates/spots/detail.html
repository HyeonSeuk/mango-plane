{% extends "base.html" %}
{% block content %}
  <div>
    <p>게시글 제목 -
    {{spot.title}}
    </p>
    <hr>
    <p>게시글 작성자 -
      {{spot.user}}</p>
    <p>
    {% if spot.user == user %}
      <a href="{% url 'spots:update_spot' spot.pk %}" class="btn btn-primary me-2">
        <span>수정</span>
      </a>
      <form action="{% url 'spots:delete' spot.pk %}" method="POST" class="d-inline-block">
        {% csrf_token %}
        <input type="submit" value="삭제" class="btn btn-danger">
      </form>
    {% else %}
    {% endif %}
    <hr>
    {% if spot.image %}
        <div class="mb-3">
          <img src="{{ spot.image.url }}" alt="{{spot.title}}">
        </div>
    {% endif %}
    <p>
      {{spot.content}}
    </p>

    <form action="{%url 'spots:likes' spot.pk %}" method="POST">
      {% csrf_token %}
      {% if request.user in spot.like_users.all %}
        <input type="submit" value = "가고싶다 취소">
      {% else %}
        <input type="submit" value = "가고싶다">
      {% endif %}
    </form>    
  </div>
  <hr>
  <form action="{% url 'spots:comment_create' spot.pk %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ comment_form.as_p }}
    <input type="submit" value="추가리뷰 작성">
  </form>
  <hr>

  {% for comment in comments %}
    <div>
      <p>리뷰 작성자 -
        {{comment.user}}</p>
      {% if comment.image %}
        <div class="mb-3">
          <img src="{{ comment.image.url }}" alt="{{comment.title}}">
        </div>
      {% endif %}
      <p>
        리뷰 내용 -
        {{comment.content}}
      </p>

      <form action="{%url 'spots:comment_likes' spot.pk comment.pk %}" method="POST">
        {% csrf_token %}
        {% if request.user in comment.like_users.all %}
          <input type="submit" value = "좋아요 취소">
        {% else %}
          <input type="submit" value = "좋아요">
        {% endif %}
      </form>

      {% if comment.user == user %}
        <form action="{% url 'spots:comment_delete' spot.pk comment.pk %}" method="POST">
          {% csrf_token %}
          <input type="submit" value="댓글 삭제">
        </form>
      {% endif %}
    </div>
    <hr>
  {% endfor %}
{% endblock content %}
